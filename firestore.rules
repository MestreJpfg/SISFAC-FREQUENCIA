/**
 * @fileoverview Firestore Security Rules for the school attendance tracker application.
 *
 * Core Philosophy:
 * This ruleset prioritizes secure access to student and attendance data.
 * The application uses anonymous authentication, so all rules are based on the assumption that request.auth will be null.
 * Since there are no authenticated users, all write operations are disabled and all data is effectively public.
 *
 * Data Structure:
 * The Firestore database consists of two top-level collections: 'students' and 'attendance'.
 * - /students/{studentId}: Stores student profile information.
 * - /attendance/{attendanceId}: Stores attendance records for students.
 *
 * Key Security Decisions:
 * - Anonymous Authentication: The app uses anonymous authentication; therefore, all writes are disabled by default.
 * - Public Read Access: Both collections are readable by everyone, including unauthenticated users.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to read student data.  Write access is denied for everyone, as the app uses anonymous auth.
     * @path /students/{studentId}
     * @allow (get, list): Any user can read student data, even without authentication.
     * @deny (create, update, delete): No one can create, update, or delete student data.
     * @principle Allows public read access for student information.
     */
    match /students/{studentId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows anyone to read attendance records. Write access is denied for everyone.
     * @path /attendance/{attendanceId}
     * @allow (get, list): Any user can read attendance records, even without authentication.
     * @deny (create, update, delete): No one can create, update, or delete attendance records.
     * @principle Allows public read access for attendance records.
     */
    match /attendance/{attendanceId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }
  }
}